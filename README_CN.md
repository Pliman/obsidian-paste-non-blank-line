# Paste Non Blank Line Obsidian Plugin

## 描述 (Description)

本插件旨在解决从 AI 助手（如 ChatGPT、Claude 等）或其他来源复制文本并粘贴到 Obsidian 时，常常会带有多余空行的问题。这些 AI 为了提高在线阅读体验，通常会在段落内部或列表项之间添加额外的空行，但这在笔记中可能显得冗余。

此插件提供了一个命令，用于清理粘贴文本或选中文本中的这些多余空行，使笔记更加整洁。**它会移除所有空白行。**

**示例：**

**原始文本 (可能来自 AI):**

```markdown
- **积极主动（Be Proactive）**

  - 做生活的主角，不被情绪或外界影响所控制。

  - 高效人士会主动承担责任，而不是推卸给环境或他人。

- **以终为始（Begin with the End in Mind）**

  - 设定明确的人生目标或愿景，做任何事都围绕长期目标展开。

  - 工作中也要目标导向，不盲目忙碌。
```

**使用本插件命令处理后:**

```markdown
- **积极主动（Be Proactive）**
  - 做生活的主角，不被情绪或外界影响所控制。
  - 高效人士会主动承担责任，而不是推卸给环境或他人。
- **以终为始（Begin with the End in Mind）**
  - 设定明确的人生目标或愿景，做任何事都围绕长期目标展开。
  - 工作中也要目标导向，不盲目忙碌。
```

## 用户体验 (User Experience)

为了避免在用户不希望的情况下自动修改粘贴内容（例如粘贴诗歌或代码），本插件采用 **命令触发** 方式，而非自动监听粘贴事件。

1.  **注册命令：** 插件会注册一个名为 "清理文本段内多余空行" (Clean Extra Blank Lines) 的命令。
2.  **使用方式：**
    - **粘贴并清理：** 复制文本后，在 Obsidian 中直接执行该命令。插件会读取剪贴板内容，清理后再插入到光标位置。
    - **清理已粘贴内容：** 先使用 `Ctrl+V` (或 `Cmd+V`) 正常粘贴文本，然后选中需要清理的区域，再执行该命令。插件会清理选中区域的文本。
3.  **快捷键：** 建议用户在 Obsidian 的 `设置 -> 快捷键` 中为 "清理文本段内多余空行" 命令设置一个自己方便且不冲突的快捷键（如 `Ctrl+Alt+V`）。

## 软件结构 (Architecture)

插件遵循标准的 Obsidian API 和项目结构：

- `main.ts`: 插件主逻辑，包含 `Plugin` 子类。
  - `onload()`: 注册清理命令。
  - `onunload()`: 注销命令。
  - `processText(text: string): string`: 实现核心清理算法。
  - 命令回调函数：获取文本（剪贴板或选区），调用 `processText`，更新编辑器内容。
- `manifest.json`: 定义插件元数据 (ID: `paste-non-blank-line`, Author: `Pliman`, etc.)。
- `README.md`: 本文档。
- `package.json`, `tsconfig.json`, `.gitignore`: 标准开发文件。

## 核心算法 (Algorithm)

清理逻辑的核心思想是：**移除所有空白行。**

1.  **获取输入：** 从剪贴板或当前选区获取字符串。
2.  **按行分割：** 将字符串按换行符 (`\n`) 分割成行数组。
3.  **迭代处理：**
    - 初始化一个空的结果行数组 `resultLines`。
    - 遍历输入行数组：
      - 检查当前行是否为空白行 ( `line.trim() === ''` )。
      - **非空白行：** 将此行加入 `resultLines`。
4.  **合并输出：** 用换行符 (`\n`) 将 `resultLines` 合并为最终的字符串。
5.  **应用结果：** 将处理后的字符串插入编辑器或替换选区。

此算法会移除所有仅包含空白字符的行。

## 安装 (Installation)

(未来添加标准 Obsidian 插件安装说明，例如通过 BRAT 或社区插件市场)

**重要:** 安装时，请确保在 `.obsidian/plugins/` 目录下创建的文件夹名称为 `paste-non-blank-line`。

## 配置 (Configuration)

- **快捷键：** 请在 Obsidian 的 `设置 -> 快捷键` 中搜索命令 "清理文本段内多余空行" 并分配您喜欢的快捷键。

## TODOs

- 添加设置选项，允许用户配置"空白行"的定义（例如，是否允许仅包含空格的行）。
- 增加对特定 Markdown 结构（如代码块）的特殊处理规则。
